require "rake/clean"
require_relative "../helper"

CLEAN << "temp" << "npm-debug.log"

file "temp" do
  mkdir "temp"
end

namespace :test do
  desc "Test the Javascript reader"
  task :reader do
    sh "nodeunit reader_test.js"
  end

  desc "Test the Javascript writer"
  task :writer do
    sh "nodeunit writer_test.js"
  end

  desc "Test the whole Javascript library"
  task js: %w[test:reader test:writer] do
  end

  desc "Test the plugins's Javascript engine"
  task :engine do
    ruby "-I../../core/lib -Idist/include/javascript engine_test.rb"
  end
end

desc "Generate solutions for some fixed problems using this plugin"
task generate: "temp" do
  generate_solutions File.dirname(__FILE__)
end

desc "Try running the solutions that were generated by rake generate"
task run: "temp" do
  try_run_solutions File.dirname(__FILE__)
end
